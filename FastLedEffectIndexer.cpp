// ****************************************************************************
//  Filename: 
//
//  Author: JP Faucher (jonpaul.faucher@gmail.com)
// ****************************************************************************
//  Details:
//
//
//  Notes:
//
// ****************************************************************************
#include "FastLedEffectIndexer.h"
#include "FastLedZone.h"

// ****************************************************************************
// Function:
// ****************************************************************************
// Arguments:
//
// ****************************************************************************
// Description:
//
// ****************************************************************************
// Notes:
//
// ****************************************************************************
FastLedEffectIndexer::FastLedEffectIndexer(FastLedZone *aZone) : 
  FastLedEffect("indexer", aZone, 2000),
  mIndex(-1)
{ 
}

// ****************************************************************************
// Function:
// ****************************************************************************
// Arguments:
//
// ****************************************************************************
// Description:
//
// ****************************************************************************
// Notes:
//
// ****************************************************************************
bool FastLedEffectIndexer::init(bool aFirstTimeInState)
{ 
  mIndex = 0;
  fill_solid_black();
  set_brightness();
  return true; 
}

// ****************************************************************************
// Function:
// ****************************************************************************
// Arguments:
//
// ****************************************************************************
// Description:
//
// ****************************************************************************
// Notes:
//
// ****************************************************************************
bool FastLedEffectIndexer::process(bool aFirstTimeInState) 
{
  EVERY_N_MILLISECONDS(mDelay)     
  {
    if(mIndex > mZone->get_zone_count() || mIndex == -1)
      mIndex = 0;
      
    fill_solid_black();
    mZone->get_zone_leds()[mIndex] = mZone->get_color();

    mLog->log("Indexer: %d - %d\r\n", mIndex, mIndex + mZone->get_start_index());

    mIndex++;
  }

  return false; 
}
